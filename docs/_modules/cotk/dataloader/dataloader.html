

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cotk.dataloader.dataloader &mdash; cotk  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/cotk_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> cotk
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/tutorial_core.html">Practice: Implement a GRU Language Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/cli_usage.html">CLI Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/extend.html">Extending Cotk: More Data, More Metrics!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notes/FAQ.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../dataloader.html">Data Loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../wordvector.html">Word Vector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../metric.html">Metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../file_utils.html">file_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../file_utils.html#resources-processor">resources_processor</a></li>
</ul>
<p class="caption"><span class="caption-text">Model Zoo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../models/LanguageGeneration/index.html">LanguageGeneration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../models/SingleTurnDialog/index.html">SingleTurnDialog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../models/MultiTurnDialog/index.html">MultiTurnDialog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">cotk</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>cotk.dataloader.dataloader</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for cotk.dataloader.dataloader</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;A module for dataloader&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">.._utils</span> <span class="kn">import</span> <span class="n">trim_before_target</span>
<span class="kn">from</span> <span class="nn">.._utils.unordered_hash</span> <span class="kn">import</span> <span class="n">UnorderedSha256</span><span class="p">,</span> <span class="n">dumps</span>
<span class="kn">from</span> <span class="nn">.._utils.metaclass</span> <span class="kn">import</span> <span class="n">DocStringInheritor</span><span class="p">,</span> <span class="n">LoadClassInterface</span><span class="p">,</span> <span class="n">copy_func</span><span class="p">,</span> <span class="n">copy_property</span>
<span class="kn">from</span> <span class="nn">.._utils.typehint</span> <span class="kn">import</span> <span class="n">OrderedDictType</span>
<span class="kn">from</span> <span class="nn">..file_utils</span> <span class="kn">import</span> <span class="n">get_resource_file_path</span>
<span class="kn">from</span> <span class="nn">.tokenizer</span> <span class="kn">import</span> <span class="n">Tokenizer</span>
<span class="kn">from</span> <span class="nn">.field</span> <span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">SentenceDefault</span><span class="p">,</span> <span class="n">_FieldContent</span><span class="p">,</span> <span class="n">Sentence</span>
<span class="kn">from</span> <span class="nn">.vocab</span> <span class="kn">import</span> <span class="n">Vocab</span><span class="p">,</span> <span class="n">GeneralVocab</span>
<span class="kn">from</span> <span class="nn">.context</span> <span class="kn">import</span> <span class="n">FieldContext</span><span class="p">,</span> <span class="n">VocabContext</span>

<div class="viewcode-block" id="Dataloader"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.Dataloader">[docs]</a><span class="k">class</span> <span class="nc">Dataloader</span><span class="p">(</span><span class="n">LoadClassInterface</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">DocStringInheritor</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;Base class of Dataloader.</span>
<span class="sd">	&#39;&#39;&#39;</span></div>



<div class="viewcode-block" id="LanguageProcessing"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing">[docs]</a><span class="k">class</span> <span class="nc">LanguageProcessing</span><span class="p">(</span><span class="n">Dataloader</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Bases: :class:`.dataloader.Dataloader`</span>

<span class="sd">	Base class for all language processing tasks. This is an abstract class.</span>

<span class="sd">	During the initialization of a dataloader, :class:`Vocab`, :class:`Tokenizer` or :class:`Field` may be created.</span>
<span class="sd">	See :ref:`how to create a dataloader&lt;customized_tasks_ref&gt;`.</span>

<span class="sd">	Arguments:{FILE_ID_DOCS}{FIELD_DETAILS}</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">FILE_ID_DOCS</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">			file_id (str): A string indicating the source (path) of the dataset. It can be local path (``&quot;./data&quot;``), a resource name</span>
<span class="s2">				(``&quot;resources://dataset&quot;``), or an url (``&quot;http://test.com/dataset.zip&quot;``).</span>
<span class="s2">				See :ref:`the details of file id&lt;file_id&gt;`.&quot;&quot;&quot;</span>

	<span class="n">FIELD_DETAILS</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">			fields (List, OrderedDict, Dict):</span>
<span class="s2">				This arguments supports multiple input types:</span>

<span class="s2">				* If ``OrderDict`` or ``List``, it specify ``data format`` of the ``&quot;train&quot;``, ``&quot;dev&quot;``, ``&quot;test&quot;`` set.</span>

<span class="s2">						* A ``data format`` should be an ``OrderedDict`` or a ``List[Tuple]`` can be converted to ``OrderedDict``.</span>
<span class="s2">						* The ``key`` of ``data format`` is the name of a Field (used by :meth:`.get_batch`),</span>
<span class="s2">						  and the ``value`` is either a class name of a Field or a :class:`Field` object.</span>
<span class="s2">						* Examples:</span>

<span class="s2">							&gt;&gt;&gt; postField = SentenceDefault(...)</span>
<span class="s2">							&gt;&gt;&gt; respField = SentenceDefault(...)</span>
<span class="s2">							&gt;&gt;&gt; data_format = [(&quot;post&quot;, postField), (&quot;resp&quot;, respField)]</span>

<span class="s2">							or</span>

<span class="s2">							&gt;&gt;&gt; data_format = [(&quot;post&quot;, &quot;SentenceDefault&quot;), (&quot;resp&quot;, &quot;SentenceDefault&quot;)]</span>
<span class="s2">						* Examples:</span>

<span class="s2">							&gt;&gt;&gt; fields = data_format</span>

<span class="s2">							equals to</span>

<span class="s2">							&gt;&gt;&gt; fields = {&quot;train&quot;: data_format, &quot;dev&quot;: data_format, &quot;test&quot;: data_format}</span>

<span class="s2">				* If ``Dict``, ``fields[key]`` describes ``data format`` of the set named ``key``. Examples:</span>

<span class="s2">					&gt;&gt;&gt; fields = {&quot;train&quot;: data_format, &quot;extra&quot;: data_format}</span>

<span class="s2">				* See :ref:`how to create a dataloader&lt;customized_tasks_ref&gt;`.&quot;&quot;&quot;</span>

	<span class="n">FIELD_REF</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">			fields (List, OrderedDict, Dict): See initialization of :class:`LanguageProcessing` for explanation. &quot;&quot;&quot;</span>

	<span class="n">SHARED_ARGUMENTS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&#39;&#39;</span><span class="si">{LanguageProcessing.FILE_ID_DOCS}</span><span class="s1"> </span><span class="si">{_FILE_ID_DEFAULT}</span><span class="s1"></span>
<span class="s1">			</span><span class="si">{LanguageProcessing.TOKENIZER_DOCS}</span><span class="s1"> </span><span class="si">{_TOKENIZER_DEFAULT}</span><span class="s1"></span>
<span class="s1">			</span><span class="si">{LanguageProcessing.MAX_SENT_LENGTH_DOCS}</span><span class="s1"> </span><span class="si">{_MAX_SENT_LENGTH_DEFAULT}</span><span class="s1"></span>
<span class="s1">			</span><span class="si">{LanguageProcessing.CONVERT_TO_LOWER_LETTER_DOCS}</span><span class="s1"> </span><span class="si">{_CONVERT_TO_LOWER_LETTER_DEFAULT}</span><span class="s1"></span>
<span class="s1">			</span><span class="si">{LanguageProcessing.MIN_FREQUENT_VOCAB_TIMES_DOCS}</span><span class="s1"> </span><span class="si">{_MIN_FREQUENT_VOCAB_TIMES_DEFAULT}</span><span class="s1"></span>
<span class="s1">			</span><span class="si">{LanguageProcessing.MIN_RARE_VOCAB_TIMES_DOCS}</span><span class="s1"> </span><span class="si">{_MIN_RARE_VOCAB_TIMES_DEFAULT}</span><span class="s1"></span>
<span class="s1">			</span><span class="si">{LanguageProcessing.PRETRAINED_DOCS}</span><span class="s1"> </span><span class="si">{_PRETAINED_DEFAULT}</span><span class="s1">&#39;&#39;&#39;</span>
	<span class="n">_FILE_ID_DEFAULT</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
	<span class="n">TOKENIZER_DOCS</span> <span class="o">=</span> <span class="n">Sentence</span><span class="o">.</span><span class="n">TOKENIZER_DOCS</span>
	<span class="n">_TOKENIZER_DEFAULT</span> <span class="o">=</span> <span class="n">Sentence</span><span class="o">.</span><span class="n">TOKENIZER_DEFAULT</span>
	<span class="n">MAX_SENT_LENGTH_DOCS</span> <span class="o">=</span> <span class="n">Sentence</span><span class="o">.</span><span class="n">MAX_SENT_LENGTH_DOCS</span>
	<span class="n">_MAX_SENT_LENGTH_DEFAULT</span> <span class="o">=</span> <span class="n">Sentence</span><span class="o">.</span><span class="n">MAX_SENT_LENGTH_DEFAULT</span>
	<span class="n">CONVERT_TO_LOWER_LETTER_DOCS</span> <span class="o">=</span> <span class="n">Sentence</span><span class="o">.</span><span class="n">CONVERT_TO_LOWER_LETTER_DOCS</span>
	<span class="n">_CONVERT_TO_LOWER_LETTER_DEFAULT</span> <span class="o">=</span> <span class="n">Sentence</span><span class="o">.</span><span class="n">CONVERT_TO_LOWER_LETTER_DEFAULT</span>
	<span class="n">MIN_FREQUENT_VOCAB_TIMES_DOCS</span> <span class="o">=</span> <span class="n">GeneralVocab</span><span class="o">.</span><span class="n">MIN_FREQUENT_VOCAB_TIMES_DOCS</span>
	<span class="n">_MIN_FREQUENT_VOCAB_TIMES_DEFAULT</span> <span class="o">=</span> <span class="n">GeneralVocab</span><span class="o">.</span><span class="n">MIN_FREQUENT_VOCAB_TIMES_DEFAULT</span>
	<span class="n">MIN_RARE_VOCAB_TIMES_DOCS</span> <span class="o">=</span> <span class="n">GeneralVocab</span><span class="o">.</span><span class="n">MIN_RARE_VOCAB_TIMES_DOCS</span>
	<span class="n">_MIN_RARE_VOCAB_TIMES_DEFAULT</span> <span class="o">=</span> <span class="n">GeneralVocab</span><span class="o">.</span><span class="n">MIN_RARE_VOCAB_TIMES_DEFAULT</span>
	<span class="n">PRETRAINED_DOCS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">			pretrained (str, optional): Use :ref:`pretrained field&lt;pretrained_field_ref&gt;` instead of :class:`SentenceDefault`.&#39;&#39;&#39;</span>
	<span class="n">_PRETAINED_DEFAULT</span> <span class="o">=</span> <span class="s2">&quot;Default: If ``None``, no pretrained field used.&quot;</span>

	<span class="c1"># for docstring</span>
	<span class="n">fields</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;OrderedDict[str, Union[str, Field]]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="sd">&#39;&#39;&#39;This instance attribute shows fields of the dataloader (See the initialization of :class:`LanguageProcessing`).</span>
<span class="sd">		For example, the fields can be printed as follows:</span>

<span class="sd">		.. code-block:: python</span>

<span class="sd">		    {</span>
<span class="sd">		        &#39;train&#39;: OrderedDict([(&#39;sent&#39;, &lt;cotk.dataloader.field.SentenceDefault object at 0x000001E170F8B588&gt;)]),</span>
<span class="sd">		        &#39;dev&#39;: OrderedDict([(&#39;sent&#39;, &lt;cotk.dataloader.field.SentenceDefault object at 0x000001E170F8BB48&gt;)]),</span>
<span class="sd">		        &#39;test&#39;: OrderedDict([(&#39;sent&#39;, &lt;cotk.dataloader.field.SentenceDefault object at 0x000001E170F8BEC8&gt;)])}</span>
<span class="sd">		    }</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> \
				 <span class="n">fields</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;OrderedDict[str, Union[str, Field]]&quot;</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]]],</span>\
					 		   <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;OrderedDict[str, Union[str, Field]]&quot;</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]]]]]],</span> \
				 <span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_id</span> <span class="o">=</span> <span class="n">file_id</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">get_resource_file_path</span><span class="p">(</span><span class="n">file_id</span><span class="p">)</span>

		<span class="k">with</span> <span class="n">FieldContext</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">GeneralVocab</span><span class="p">(),</span> <span class="n">weak</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">field_context</span><span class="p">:</span>

			<span class="n">fieldcontents</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">_FieldContent</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
				<span class="n">fields</span> <span class="o">=</span> <span class="p">{</span><span class="n">set_name</span><span class="p">:</span> <span class="n">fields</span> <span class="k">for</span> <span class="n">set_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">]}</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
				<span class="k">for</span> <span class="n">set_name</span><span class="p">,</span> <span class="n">fields_in_one_set</span> <span class="ow">in</span> <span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
					<span class="n">one_fields</span><span class="p">,</span> <span class="n">one_fieldcontents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_field_and_create_content</span><span class="p">(</span><span class="n">set_name</span><span class="p">,</span> <span class="n">fields_in_one_set</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">one_fields</span>
					<span class="n">fieldcontents</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">one_fieldcontents</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unknown type for fields&quot;</span><span class="p">)</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_load_data</span><span class="p">(</span><span class="n">fieldcontents</span><span class="p">)</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">vocabs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collect_vocabs_from_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
			<span class="c1"># self.default_vocab_id = 0 if len(self.vocabs) == 1 else None</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tokenizers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collect_tokenizers_from_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
			<span class="c1"># self.default_tokenizer_id = 0 if len(self.tokenizers) == 1 else None</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">default_field_set_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">default_field_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_build_vocabs</span><span class="p">()</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_setting_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_setting_hash</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_vocab_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_vocab_hash</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data</span><span class="p">(</span><span class="n">fieldcontents</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_raw_data_hash</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_data_hash</span><span class="p">(</span><span class="n">fieldcontents</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_batch</span><span class="p">(</span><span class="n">fieldcontents</span><span class="p">)</span>

<div class="viewcode-block" id="LanguageProcessing.simple_create"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.simple_create">[docs]</a>	<span class="nd">@staticmethod</span>
	<span class="k">def</span> <span class="nf">simple_create</span><span class="p">(</span><span class="n">file_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> \
				<span class="n">fields</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]],</span>\
					 		   <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]]]],</span> \
				<span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LanguageProcessing&quot;</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;A simple way to create a dataloader. Instead of using :class:`VocabContext`</span>
<span class="sd">		and :class:`FieldContext`, specifying all the possible parameters here.</span>

<span class="sd">		Arguments:{FILE_ID_DOCS}{FIELD_REF}</span>
<span class="sd">			**kwargs: Arguments passed to created :class:`Vocab` and :class:`Field`.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">with</span> <span class="n">VocabContext</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
			<span class="k">with</span> <span class="n">FieldContext</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
				<span class="k">with</span> <span class="n">FieldContext</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">=</span><span class="s2">&quot;space&quot;</span><span class="p">,</span> <span class="n">weak</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
					<span class="k">return</span> <span class="n">LanguageProcessing</span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span></div>

	<span class="k">def</span> <span class="nf">_load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fieldcontents</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">_FieldContent</span><span class="p">]]):</span>
		<span class="sd">&#39;&#39;&#39;Load data from file.</span>
<span class="sd">		Arguments:</span>
<span class="sd">			fieldcontents (Dict[str, OrderedDictType[str, _FieldContent]]): fieldcontents for each set</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">for</span> <span class="n">set_name</span><span class="p">,</span> <span class="n">fieldcontents_in_one_set</span> <span class="ow">in</span> <span class="n">fieldcontents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">fieldcontents_in_one_set</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;no field specified&quot;</span><span class="p">)</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">.txt&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span> <span class="n">set_name</span><span class="p">),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_file</span><span class="p">:</span>
				<span class="n">line_cnt</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">file_iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">f_file</span><span class="p">)</span>
				<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">fieldcontent</span> <span class="ow">in</span> <span class="n">fieldcontents_in_one_set</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
							<span class="n">line_add</span> <span class="o">=</span> <span class="n">fieldcontent</span><span class="o">.</span><span class="n">read_next</span><span class="p">(</span><span class="n">file_iterator</span><span class="p">)</span>
							<span class="k">if</span> <span class="n">line_add</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
								<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
									<span class="k">if</span> <span class="nb">next</span><span class="p">(</span><span class="n">file_iterator</span><span class="p">):</span>
										<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;the file </span><span class="si">%s</span><span class="s2"> corrupted at line </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">set_name</span><span class="p">,</span> <span class="n">line_cnt</span><span class="p">))</span>
							<span class="n">line_cnt</span> <span class="o">+=</span> <span class="n">line_add</span>
					<span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
						<span class="k">break</span>

			<span class="n">sample_nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">fieldcontent</span><span class="o">.</span><span class="n">get_data_number</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">fieldcontent</span> <span class="ow">in</span> <span class="n">fieldcontents_in_one_set</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">sample_num</span> <span class="o">==</span> <span class="n">sample_nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">sample_num</span> <span class="ow">in</span> <span class="n">sample_nums</span><span class="p">]):</span>
				<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;the file </span><span class="si">%s</span><span class="s2"> corrupted at end of the file&quot;</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">fieldcontents_in_one_set</span> <span class="ow">in</span> <span class="n">fieldcontents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">fieldcontent</span> <span class="ow">in</span> <span class="n">fieldcontents_in_one_set</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
				<span class="n">fieldcontent</span><span class="o">.</span><span class="n">process_before_vocab</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">_init_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fieldcontents</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">_FieldContent</span><span class="p">]])</span> <span class="o">-&gt;</span> \
			<span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]:</span>
		<span class="sd">&#39;&#39;&#39;Initialize the batches. Return a tuple contains</span>
<span class="sd">		``index``, ``batch_id``, ``batch_size`` for each set.</span>
<span class="sd">		Arguments:</span>
<span class="sd">			fieldcontents (Dict[str, OrderedDictType[str, _FieldContent]]): fieldcontents for each set.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">index</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">batch_id</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">batch_size</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

		<span class="k">for</span> <span class="n">set_name</span><span class="p">,</span> <span class="n">fieldcontents_in_one_set</span> <span class="ow">in</span> <span class="n">fieldcontents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="n">sample_nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">fieldcontent</span><span class="o">.</span><span class="n">get_data_number</span><span class="p">()</span> \
					<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">fieldcontent</span> <span class="ow">in</span> <span class="n">fieldcontents_in_one_set</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
			<span class="n">batch_id</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">batch_size</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="n">index</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">sample_nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

		<span class="k">return</span> <span class="n">index</span><span class="p">,</span> <span class="n">batch_id</span><span class="p">,</span> <span class="n">batch_size</span>

	<span class="k">def</span> <span class="nf">_get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fieldcontents</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">_FieldContent</span><span class="p">]])</span> <span class="o">-&gt;</span> \
			<span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
		<span class="sd">&#39;&#39;&#39;Get the data from fieldcontents.</span>
<span class="sd">		Arguments:</span>
<span class="sd">			fieldcontents (Dict[str, OrderedDict[str, _FieldContent]]): fieldcontents for each set.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">set_name</span><span class="p">,</span> <span class="n">fieldcontents_in_one_set</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fieldcontents</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="n">data</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">fieldcontent</span> <span class="ow">in</span> <span class="n">fieldcontents_in_one_set</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
				<span class="n">data</span><span class="p">[</span><span class="n">set_name</span><span class="p">][</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">fieldcontent</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">data</span>

	<span class="k">def</span> <span class="nf">_build_vocabs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Invoke build vocab for each vocabulary&#39;&#39;&#39;</span>
		<span class="k">for</span> <span class="n">vocab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocabs</span><span class="p">:</span>
			<span class="n">vocab</span><span class="o">.</span><span class="n">build_vocab</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">_collect_vocabs_from_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]])</span>\
			<span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Vocab</span><span class="p">]:</span>
		<span class="sd">&#39;&#39;&#39;Collect all vocabulary instances (deduplicated).</span>
<span class="sd">		Arguments:</span>
<span class="sd">			fieldcontents (Dict[str, OrderedDict[str, Field]]): field for each set.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">vocabs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Vocab</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">fields_in_one_set</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="c1"># sort to keep order</span>
			<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_in_one_set</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
				<span class="n">vocab</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">get_vocab</span><span class="p">()</span>
				<span class="k">if</span> <span class="n">vocab</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">vocab</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vocabs</span><span class="p">:</span>
					<span class="n">vocabs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">vocabs</span>

	<span class="k">def</span> <span class="nf">_collect_tokenizers_from_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]])</span>\
			<span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tokenizer</span><span class="p">]:</span>
		<span class="sd">&#39;&#39;&#39;Collect all tokenizer instances (deduplicated).</span>
<span class="sd">		Arguments:</span>
<span class="sd">			fieldcontents (Dict[str, OrderedDict[str, Field]]): field for each set.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">tokenizers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tokenizer</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">tokenizers_setting_hash</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">fields_in_one_set</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span> <span class="c1"># sort to keep order</span>
			<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_in_one_set</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
				<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">get_tokenizer</span><span class="p">()</span>
				<span class="k">if</span> <span class="n">tokenizer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">get_setting_hash</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tokenizers_setting_hash</span><span class="p">:</span>
					<span class="n">tokenizers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span>
					<span class="n">tokenizers_setting_hash</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">get_setting_hash</span><span class="p">())</span>
		<span class="k">return</span> <span class="n">tokenizers</span>

	<span class="k">def</span> <span class="nf">_fill_field_and_create_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> \
				<span class="n">Union</span><span class="p">[</span><span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]],</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]]]],</span> \
				<span class="p">)</span> <span class="o">-&gt;</span> \
					<span class="n">Tuple</span><span class="p">[</span><span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">],</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">_FieldContent</span><span class="p">]]:</span>
		<span class="sd">&#39;&#39;&#39;Create and return fields and field contexts.</span>
<span class="sd">		Arguments:</span>
<span class="sd">			set_name(str): name of the set</span>
<span class="sd">			field (OrderedDictType[str, Union[str, Field]]): fields for the set.</span>
<span class="sd">		&#39;&#39;&#39;</span>

		<span class="n">fieldcontents</span><span class="p">:</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">_FieldContent</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
		<span class="n">new_fields</span><span class="p">:</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

		<span class="n">fields_iter</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">]]]</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">):</span>
			<span class="n">fields_iter</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
			<span class="n">fields_iter</span> <span class="o">=</span> <span class="n">fields</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected Type for fields&quot;</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field_name</span> <span class="ow">in</span> <span class="n">fields_iter</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
				<span class="n">field</span> <span class="o">=</span> <span class="n">Field</span><span class="o">.</span><span class="n">load_class</span><span class="p">(</span><span class="n">field_name</span><span class="p">)()</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">Field</span><span class="p">):</span>
				<span class="n">field</span> <span class="o">=</span> <span class="n">field_name</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Each value of `fields` must be a Field object or a string indicating the name of a Field class.&quot;</span><span class="p">)</span>
			<span class="n">fieldcontent</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">_create</span><span class="p">(</span><span class="n">set_name</span><span class="p">)</span> <span class="c1">#pylint: disable=protected-access</span>
			<span class="n">fieldcontents</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">fieldcontent</span>
			<span class="n">new_fields</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span>
		<span class="k">return</span> <span class="n">new_fields</span><span class="p">,</span> <span class="n">fieldcontents</span>

	<span class="k">def</span> <span class="nf">_create_data_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fieldcontents</span><span class="p">):</span>
		<span class="n">raw_data_hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">()</span>
		<span class="n">data_hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">fieldcontents_in_one_set</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">fieldcontents</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">fieldcontent</span> <span class="ow">in</span> <span class="n">fieldcontents_in_one_set</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
				<span class="n">raw_data_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">fieldcontent</span><span class="o">.</span><span class="n">get_raw_data_hash</span><span class="p">()))</span>
				<span class="n">data_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">fieldcontent</span><span class="o">.</span><span class="n">get_data_hash</span><span class="p">()))</span>
		<span class="k">return</span> <span class="n">raw_data_hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="n">data_hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">_create_setting_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">setting_hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">fields_in_one_set</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_in_one_set</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
				<span class="n">setting_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">_get_setting_hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabs</span><span class="p">)))</span> <span class="c1">#pylint: disable=protected-access</span>
		<span class="k">for</span> <span class="n">vocab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocabs</span><span class="p">:</span>
			<span class="n">setting_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">get_setting_hash</span><span class="p">()))</span>
		<span class="k">for</span> <span class="n">tokenizer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizers</span><span class="p">:</span>
			<span class="n">setting_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">get_setting_hash</span><span class="p">()))</span>
		<span class="k">return</span> <span class="n">setting_hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

	<span class="k">def</span> <span class="nf">_create_vocab_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">vocab_hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">vocab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocabs</span><span class="p">:</span>
			<span class="n">vocab_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">get_vocab_hash</span><span class="p">()))</span>
		<span class="k">return</span> <span class="n">vocab_hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<div class="viewcode-block" id="LanguageProcessing.get_default_vocab"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_default_vocab">[docs]</a>	<span class="k">def</span> <span class="nf">get_default_vocab</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vocab</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;Get the default :class:`Vocab` in this dataloader.</span>
<span class="sd">		It can be set by :meth:`.set_default_field`.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">vocab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_field</span><span class="p">()</span><span class="o">.</span><span class="n">get_vocab</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">vocab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This field do not have vocab&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">vocab</span></div>

<div class="viewcode-block" id="LanguageProcessing.get_default_tokenizer"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_default_tokenizer">[docs]</a>	<span class="k">def</span> <span class="nf">get_default_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tokenizer</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;Get the default :class:`Tokenizer` in this dataloader.</span>
<span class="sd">		It can be set by :meth:`.set_default_field`.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">tokenizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_field</span><span class="p">()</span><span class="o">.</span><span class="n">get_tokenizer</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">tokenizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This field do not have tokenizer&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">tokenizer</span></div>

<div class="viewcode-block" id="LanguageProcessing.get_default_field"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_default_field">[docs]</a>	<span class="k">def</span> <span class="nf">get_default_field</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Field</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;Get the default :class:`Field` in this dataloader.</span>
<span class="sd">		It can be set by :meth:`.set_default_field`.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_field_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_field_set_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No default field. </span><span class="se">\</span>
<span class="s2">				Specify the default field by set_default_field.&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default_field_set_name</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">default_field_name</span><span class="p">]</span></div>

	<span class="n">SET_NAME_DESCRIPTION</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;set_name (str): The name of set. For example: ``&quot;train&quot;``, ``&quot;dev&quot;``, ``&quot;test&quot;``.&#39;&#39;&#39;</span>
	<span class="n">FIELD_NAME_DESCRIPTION</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;field_name (str): The name of field.&#39;&#39;&#39;</span>

<div class="viewcode-block" id="LanguageProcessing.set_default_field"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.set_default_field">[docs]</a>	<span class="k">def</span> <span class="nf">set_default_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Set the default :class:`Field` in this dataloader. In the meanwhile,</span>
<span class="sd">		the default :class:`Vocab` and :class:`Tokenizer` is also set according</span>
<span class="sd">		to the field (if the field have vocab and tokenizer).</span>

<span class="sd">		The default field will affect the action in the following methods:</span>

<span class="sd">		* :meth:`get_default_field`</span>
<span class="sd">		* :meth:`tokenize`</span>
<span class="sd">		* :meth:`tokenize_sentences`</span>
<span class="sd">		* :meth:`convert_tokens_to_ids`</span>
<span class="sd">		* :meth:`convert_ids_to_tokens`</span>
<span class="sd">		* :meth:`convert_ids_to_sentence`</span>
<span class="sd">		* :meth:`convert_sentence_to_ids`</span>
<span class="sd">		* :meth:`add_special_to_ids`</span>
<span class="sd">		* :meth:`remove_special_in_ids`</span>
<span class="sd">		* :meth:`process_sentences`</span>
<span class="sd">		* :meth:`trim_in_ids`</span>
<span class="sd">		* :meth:`get_default_vocab`</span>
<span class="sd">		* :meth:`get_special_tokens_mapping`</span>
<span class="sd">		* :meth:`get_special_tokens_id`</span>
<span class="sd">		* :meth:`get_default_tokenizer`</span>

<span class="sd">		Arguments:</span>
<span class="sd">			{SET_NAME_DESCRIPTION}</span>
<span class="sd">			{FIELD_NAME_DESCRIPTION}</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">set_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;No such set named </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">set_name</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">field_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">set_name</span><span class="p">]:</span>
			<span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;No such field named </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">field_name</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">default_field_set_name</span> <span class="o">=</span> <span class="n">set_name</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">default_field_name</span> <span class="o">=</span> <span class="n">field_name</span></div>

		<span class="c1"># tokenizer = self.fields[set_name][field_name].get_tokenizer()</span>
		<span class="c1"># if tokenizer:</span>
		<span class="c1"># 	self.set_default_tokenizer(tokenizer)</span>
		<span class="c1"># vocab = self.fields[set_name][field_name].get_vocab()</span>
		<span class="c1"># if vocab:</span>
		<span class="c1"># 	self.set_default_vocab(vocab)</span>

<div class="viewcode-block" id="LanguageProcessing.get_field"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_field">[docs]</a>	<span class="k">def</span> <span class="nf">get_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Field</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;Get :class:`Field` according to name of set and field.</span>

<span class="sd">		Arguments:</span>
<span class="sd">			{SET_NAME_DESCRIPTION}</span>
<span class="sd">			{FIELD_NAME_DESCRIPTION}</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">set_name</span><span class="p">][</span><span class="n">field_name</span><span class="p">]</span></div>

<div class="viewcode-block" id="LanguageProcessing.get_general_hash"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_general_hash">[docs]</a>	<span class="k">def</span> <span class="nf">get_general_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;General hash. Identifying all details in dataloader,</span>
<span class="sd">		including raw data before processed, tokenized data, vocabulary, and settings.</span>

<span class="sd">		See :ref:`dataloader hash&lt;dataloader_hash_ref&gt;` for explaination.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">general_hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">()</span>
		<span class="n">general_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_raw_data_hash</span><span class="p">))</span>
		<span class="n">general_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_hash</span><span class="p">))</span>
		<span class="n">general_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vocab_hash</span><span class="p">))</span>
		<span class="n">general_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setting_hash</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">general_hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span></div>

<div class="viewcode-block" id="LanguageProcessing.get_raw_data_hash"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_raw_data_hash">[docs]</a>	<span class="k">def</span> <span class="nf">get_raw_data_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;Raw data hash. Identifying raw data before processed.</span>

<span class="sd">		See :ref:`dataloader hash&lt;dataloader_hash_ref&gt;` for explaination.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raw_data_hash</span></div>

<div class="viewcode-block" id="LanguageProcessing.get_data_hash"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_data_hash">[docs]</a>	<span class="k">def</span> <span class="nf">get_data_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;Data hash. Identifying data after processed (tokenized).</span>

<span class="sd">		See :ref:`dataloader hash&lt;dataloader_hash_ref&gt;` for explaination.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_hash</span></div>

<div class="viewcode-block" id="LanguageProcessing.get_vocab_hash"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_vocab_hash">[docs]</a>	<span class="k">def</span> <span class="nf">get_vocab_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;Vocab hash. Identifying vocabulary.</span>

<span class="sd">		See :ref:`dataloader hash&lt;dataloader_hash_ref&gt;` for explaination.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vocab_hash</span></div>

<div class="viewcode-block" id="LanguageProcessing.get_setting_hash"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_setting_hash">[docs]</a>	<span class="k">def</span> <span class="nf">get_setting_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
		<span class="sd">&#39;&#39;&#39;Setting hash, identifying settings to create the data loader.</span>

<span class="sd">		See :ref:`dataloader hash&lt;dataloader_hash_ref&gt;` for explaination.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setting_hash</span></div>

<div class="viewcode-block" id="LanguageProcessing.restart"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.restart">[docs]</a>	<span class="k">def</span> <span class="nf">restart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_name</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Initialize batches. This function be called before :func:`get_next_batch`</span>
<span class="sd">		or an epoch is end. See :meth:`get_next_batch` for examples.</span>

<span class="sd">		Arguments:</span>
<span class="sd">			{SET_NAME_DESCRIPTION}</span>
<span class="sd">			batch_size (int): the number of sample in a batch.</span>
<span class="sd">				default: if ``None``, last ``batch_size`` is used.</span>
<span class="sd">			shuffle (bool): whether to shuffle the data. Default: ``True``.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">set_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No set named </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">set_name</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">batch_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You need batch_size to initialize.&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">shuffle</span><span class="p">:</span>
			<span class="c1"># rng_state = random.getstate()</span>
			<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">set_name</span><span class="p">])</span>
			<span class="c1"># random.setstate(rng_state)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">batch_id</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">if</span> <span class="n">batch_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch_size</span>
		<span class="n">batch_size_div</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span>
		<span class="k">assert</span> <span class="n">batch_size_div</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> set restart, </span><span class="si">%d</span><span class="s2"> batches and </span><span class="si">%d</span><span class="s2"> left&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">set_name</span><span class="p">,</span> \
						<span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">set_name</span><span class="p">])</span> <span class="o">//</span> <span class="n">batch_size_div</span><span class="p">,</span> \
						<span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">set_name</span><span class="p">])</span> <span class="o">%</span> <span class="n">batch_size_div</span><span class="p">))</span></div>

	<span class="n">_GET_BATCH_MORE_DOC</span> <span class="o">=</span> <span class="s2">&quot;Return a merged dict containing all the data from each field by calling :meth:`.field.get_batch`. &quot;</span> \
		<span class="s2">&quot;See examples in subclasses for the return value of predefined tasks.&quot;</span>
	<span class="n">_GET_BATCH_EXAMPLE</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<div class="viewcode-block" id="LanguageProcessing.get_batch"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_batch">[docs]</a>	<span class="k">def</span> <span class="nf">get_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">indexes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
		<span class="sd">&#39;&#39;&#39;Get a batch of data with specified ``indexes``.</span>
<span class="sd">		{_GET_BATCH_MORE_DOC}</span>

<span class="sd">		:meth:`get_next_batch`, :meth:`get_batches`, :meth:`get_all_batch` provide other methods to get batched data,</span>
<span class="sd">		Their return values are consistent with this methods.</span>

<span class="sd">		Arguments:</span>
<span class="sd">			{SET_NAME_DESCRIPTION}</span>
<span class="sd">			indexes (list): a list of specified indexes of batched data.</span>

<span class="sd">		{_GET_BATCH_EXAMPLE}</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">set_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No set named </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">set_name</span><span class="p">)</span>
		<span class="n">res</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">field_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
			<span class="n">res</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">field_obj</span><span class="o">.</span><span class="n">get_batch</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">set_name</span><span class="p">][</span><span class="n">field_name</span><span class="p">],</span> <span class="n">indexes</span><span class="p">))</span> <span class="c1">#pylint: disable=protected-access</span>
		<span class="k">return</span> <span class="n">res</span></div>

	<span class="n">IGNORE_LEFT_SAMPLES</span> <span class="o">=</span> <span class="s2">&quot;ignore_left_samples (bool): If the number of the samples is not divisible by ``batch_size``, &quot;</span> \
			<span class="s2">&quot;ignore the left samples less than ``batch_size`` &quot;</span> \
			<span class="s2">&quot;Setting it to ``True`` make that every batch will have the same number of samples. &quot;</span> \
			<span class="s2">&quot;Default: ``False``.&quot;</span>
<div class="viewcode-block" id="LanguageProcessing.get_next_batch"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_next_batch">[docs]</a>	<span class="k">def</span> <span class="nf">get_next_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_name</span><span class="p">,</span> <span class="n">ignore_left_samples</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
		<span class="sd">&#39;&#39;&#39;Get next batch. It can be called only after Initializing batches (:func:`restart`).</span>
<span class="sd">		Return a dict like :func:`get_batch`, or None if the epoch is end.</span>

<span class="sd">		Arguments:</span>
<span class="sd">			{SET_NAME_DESCRIPTION}</span>
<span class="sd">			{IGNORE_LEFT_SAMPLES}</span>

<span class="sd">		Examples:</span>

<span class="sd">			&gt;&gt;&gt; dataloader.restart(&quot;train&quot;)</span>
<span class="sd">			&gt;&gt;&gt; while True:</span>
<span class="sd">			&gt;&gt;&gt;     data = dataloader.get_next_batch(&quot;train&quot;)</span>
<span class="sd">			&gt;&gt;&gt;     if data:</span>
<span class="sd">			&gt;&gt;&gt;         break</span>
<span class="sd">            &gt;&gt;&gt;     print(data)</span>

<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">set_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No set named </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">set_name</span><span class="p">)</span>
		<span class="n">batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">batch_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span> \
				<span class="s2">&quot;Please run restart before calling this function.&quot;</span><span class="p">)</span>
		<span class="n">batch_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_id</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span>

		<span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">batch_id</span> <span class="o">*</span> \
					 	<span class="n">batch_size</span><span class="p">,</span> <span class="p">(</span><span class="n">batch_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">batch_size</span>
		<span class="k">if</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">set_name</span><span class="p">]):</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="k">if</span> <span class="n">ignore_left_samples</span> <span class="ow">and</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">set_name</span><span class="p">]):</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">set_name</span><span class="p">][</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
		<span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_batch</span><span class="p">(</span><span class="n">set_name</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">batch_id</span><span class="p">[</span><span class="n">set_name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
		<span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="LanguageProcessing.get_batches"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_batches">[docs]</a>	<span class="k">def</span> <span class="nf">get_batches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_name</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
			<span class="n">ignore_left_samples</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
		<span class="sd">&#39;&#39;&#39;An iterable generator over batches. It first call :func:`restart`, and then :func:`get_next_batch`</span>
<span class="sd">		until no more data is available. Returns an iterable generator where each element is like :func:`get_batch`.</span>

<span class="sd">		Arguments:</span>
<span class="sd">			{SET_NAME_DESCRIPTION}</span>
<span class="sd">			batch_size (int, optional): default: ``None``.  Use ``batch_size`` by default.</span>
<span class="sd">			shuffle (bool): whether to shuffle the data. Default: ``True``.</span>
<span class="sd">			{IGNORE_LEFT_SAMPLES}</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">restart</span><span class="p">(</span><span class="n">set_name</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="p">)</span>
		<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
			<span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_batch</span><span class="p">(</span><span class="n">set_name</span><span class="p">,</span> <span class="n">ignore_left_samples</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">break</span>
			<span class="k">yield</span> <span class="n">res</span></div>

<div class="viewcode-block" id="LanguageProcessing.get_all_batch"><a class="viewcode-back" href="../../../dataloader.html#cotk.dataloader.LanguageProcessing.get_all_batch">[docs]</a>	<span class="k">def</span> <span class="nf">get_all_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">set_name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
		<span class="sa">r</span><span class="sd">&#39;&#39;&#39;Concatenate all batches to a single dict, where padding will not be applied.</span>

<span class="sd">		Returns a dict like :func:`get_batch` with all valid ``indexes``,</span>
<span class="sd">		but all the sentences are not padded and their type will be converted to list.</span>
<span class="sd">		Exactly, this function called :func:`get_batch` where ``len(indexes)==1`` multiple times</span>
<span class="sd">		and concatenate all the values in the returned dicts.</span>

<span class="sd">		Arguments:</span>
<span class="sd">			{SET_NAME_DESCRIPTION}</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">res</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">set_name</span><span class="p">]:</span>
			<span class="n">batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_batch</span><span class="p">(</span><span class="n">set_name</span><span class="p">,</span> <span class="p">[</span><span class="n">idx</span><span class="p">])</span>
			<span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">batch</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
				<span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
					<span class="n">res</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
					<span class="n">val</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">]</span>
				<span class="n">res</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">res</span></div>

	<span class="c1"># copy some functions from vocab</span>
	<span class="n">_VOCAB_MORE_DOCSTRING</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;It calls the identical method of the :class:`Vocab` instance ``vocab``,</span><span class="se">\</span>
<span class="s1">		from :meth:`.get_default_vocab()`.&#39;&#39;&#39;</span>
	<span class="n">frequent_vocab_size</span> <span class="o">=</span> <span class="n">copy_property</span><span class="p">(</span><span class="n">get_default_vocab</span><span class="p">,</span> <span class="n">Vocab</span><span class="p">,</span> <span class="s2">&quot;frequent_vocab_size&quot;</span><span class="p">)</span>
	<span class="n">all_vocab_size</span> <span class="o">=</span> <span class="n">copy_property</span><span class="p">(</span><span class="n">get_default_vocab</span><span class="p">,</span> <span class="n">Vocab</span><span class="p">,</span> <span class="s2">&quot;all_vocab_size&quot;</span><span class="p">)</span>
	<span class="n">frequent_vocab_list</span> <span class="o">=</span> <span class="n">copy_property</span><span class="p">(</span><span class="n">get_default_vocab</span><span class="p">,</span> <span class="n">Vocab</span><span class="p">,</span> <span class="s2">&quot;frequent_vocab_list&quot;</span><span class="p">)</span>
	<span class="n">all_vocab_list</span> <span class="o">=</span> <span class="n">copy_property</span><span class="p">(</span><span class="n">get_default_vocab</span><span class="p">,</span> <span class="n">Vocab</span><span class="p">,</span> <span class="s2">&quot;all_vocab_list&quot;</span><span class="p">)</span>
	<span class="n">get_special_tokens_mapping</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_vocab</span><span class="p">,</span> <span class="n">Vocab</span><span class="p">,</span> <span class="s2">&quot;get_special_tokens_mapping&quot;</span><span class="p">)</span>
	<span class="n">get_special_tokens_id</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_vocab</span><span class="p">,</span> <span class="n">Vocab</span><span class="p">,</span> <span class="s2">&quot;get_special_tokens_id&quot;</span><span class="p">)</span>
	<span class="n">pad_id</span> <span class="o">=</span> <span class="n">copy_property</span><span class="p">(</span><span class="n">get_default_vocab</span><span class="p">,</span> <span class="n">Vocab</span><span class="p">,</span> <span class="s2">&quot;pad_id&quot;</span><span class="p">)</span>
	<span class="n">unk_id</span> <span class="o">=</span> <span class="n">copy_property</span><span class="p">(</span><span class="n">get_default_vocab</span><span class="p">,</span> <span class="n">Vocab</span><span class="p">,</span> <span class="s2">&quot;unk_id&quot;</span><span class="p">)</span>
	<span class="n">go_id</span> <span class="o">=</span> <span class="n">copy_property</span><span class="p">(</span><span class="n">get_default_vocab</span><span class="p">,</span> <span class="n">Vocab</span><span class="p">,</span> <span class="s2">&quot;go_id&quot;</span><span class="p">)</span>
	<span class="n">eos_id</span> <span class="o">=</span> <span class="n">copy_property</span><span class="p">(</span><span class="n">get_default_vocab</span><span class="p">,</span> <span class="n">Vocab</span><span class="p">,</span> <span class="s2">&quot;eos_id&quot;</span><span class="p">)</span>

	<span class="n">_SENTENCE_MORE_DOCSTRING</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;It calls the identical method of the :class:`Sentence` instance ``sentence``,</span><span class="se">\</span>
<span class="s1">		from :meth:`.get_default_field()`.&#39;&#39;&#39;</span>
	<span class="n">_SESSION_MORE_DOCSTRING</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;It calls the identical method of the :class:`Session` instance ``session``,</span><span class="se">\</span>
<span class="s1">		from :meth:`.get_default_field()`.&#39;&#39;&#39;</span>
	<span class="n">tokenize</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_field</span><span class="p">,</span> <span class="n">Sentence</span><span class="p">,</span> <span class="s2">&quot;tokenize&quot;</span><span class="p">)</span>
	<span class="n">tokenize_sentences</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_field</span><span class="p">,</span> <span class="n">Sentence</span><span class="p">,</span> <span class="s2">&quot;tokenize_sentences&quot;</span><span class="p">)</span>
	<span class="n">convert_tokens_to_ids</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_field</span><span class="p">,</span> <span class="n">Sentence</span><span class="p">,</span> <span class="s2">&quot;convert_tokens_to_ids&quot;</span><span class="p">)</span>
	<span class="n">convert_ids_to_tokens</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_field</span><span class="p">,</span> <span class="n">Sentence</span><span class="p">,</span> <span class="s2">&quot;convert_ids_to_tokens&quot;</span><span class="p">)</span>
	<span class="n">convert_ids_to_sentence</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_field</span><span class="p">,</span> <span class="n">Sentence</span><span class="p">,</span> <span class="s2">&quot;convert_ids_to_sentence&quot;</span><span class="p">)</span>
	<span class="n">convert_sentence_to_ids</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_field</span><span class="p">,</span> <span class="n">Sentence</span><span class="p">,</span> <span class="s2">&quot;convert_sentence_to_ids&quot;</span><span class="p">)</span>
	<span class="n">add_special_to_ids</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_field</span><span class="p">,</span> <span class="n">Sentence</span><span class="p">,</span> <span class="s2">&quot;add_special_to_ids&quot;</span><span class="p">)</span>
	<span class="n">remove_special_in_ids</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_field</span><span class="p">,</span> <span class="n">Sentence</span><span class="p">,</span> <span class="s2">&quot;remove_special_in_ids&quot;</span><span class="p">)</span>
	<span class="n">process_sentences</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_field</span><span class="p">,</span> <span class="n">Sentence</span><span class="p">,</span> <span class="s2">&quot;process_sentences&quot;</span><span class="p">)</span>
	<span class="n">trim_in_ids</span> <span class="o">=</span> <span class="n">copy_func</span><span class="p">(</span><span class="n">get_default_field</span><span class="p">,</span> <span class="n">Sentence</span><span class="p">,</span> <span class="s2">&quot;trim_in_ids&quot;</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, thu-coai

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>